# SINDO_ORCA_PROJECT README

## 開発環境
- Python 3.10.12
- ORCA 6.0
- SINDO 4.0
## 必要モジュール
以下のモジュールを使用します。（標準ライブラリは省略）

```python
import numpy as np
import itertools
from concurrent.futures import ThreadPoolExecutor, as_completed
```

## 実行方法

1. **ORCA で分子の構造最適化を行う。**
2. `orca_minfo/main.py` を実行する。
   - ORCA のアウトプットファイルのディレクトリと、ファイル名（拡張子なし）を入力する。
   - `output/` ディレクトリに `.minfo` ファイルが生成される。
3. `minfo_QFF/main.py` を実行する。
   - 振動モードの次数 (`MR`) を入力する。
   - `output/` ディレクトリに `makePES` を実行するためのファイル `run_qff.sh` が生成される。
   - これを実行する。
4. `QFF_xyz/main.py` を実行する。
   - `output/` ディレクトリに `makeGRID` を実行するためのファイル `run_grid.sh` が生成される。
   - これを実行する。
5. `grid/main.py` を実行する。
   - 初期設定では、Free の CPU コアを全て使用して並列処理するので注意。
6. 以上の手順で、`output/` ディレクトリ内に **SINDO に必要なファイル** が出力される。
   - `.minfo`
   - `/pot/` ディレクトリに `.pot` と `.dipole`

## .minfo の仕様

`.minfo` ファイルには以下の情報が記述される。

### [ Atomic Data ]
以下のような形式で記述される:

```
4
 N, 7, 14.00700, -0.00000979766170, 0.00000001023639, 0.15618266605276
 H, 1, 1.00800, 0.93780599077684, -0.00000002171415, -0.25206416695381
 ...
```

- **最初の数値**: 原子の数
- **各行のデータ**:
  - 元素記号
  - 原子番号
  - 原子量
  - 座標 (X, Y, Z)

### [ Electronic Data ]
- **Energy (エネルギー)**: 分子の全エネルギー。
- **Charge (電荷)**: 分子全体の電荷状態。
- **Multiplicity (多重度)**: スピン多重度（`2S+1` で表される）。
- **Gradient (勾配)**: エネルギーの勾配（各座標ごとの変化率）。
- **Hessian (ヘシアン行列)**: 2階微分行列で、ポテンシャルエネルギー表面の曲率を示す。
- **Dipole Moment (双極子モーメント)**: 分子の極性を示す指標。
- **Polarizability (分極率)**: 外部電場による電子雲の変形度合い。
- **Dipole Derivative (双極子微分係数)**: 振動モードごとの双極子変化を表す。

### .pot と .dipole の仕様

#### 振動モードが 1 つの場合
```
B3LYP/cc-pVDZ (11)
# Number of grids and data
    11      1 
#   q3              Energy
   -27.68533983     1.4771550955e-01
   -21.00502784     7.7402241929e-02
   -15.28949299     3.8599008997e-02
```
- **基底関数**: 計算に用いた基底関数。
- **グリッド数**: 解析対象の振動座標の点数。
- **座標部分**: 振動座標と平衡座標の変位ベクトルに原子の重み付けをし、それに対応する基準振動ベクトルの内積を 50 倍したもの。
- **エネルギー**: ORCA でエネルギー計算を行い、平衡座標でのエネルギーとの差分を記録。

#### 振動モードが複数のカップリングの場合
```
B3LYP/cc-pVDZ (11)
# Number of grids and data
    11     11     11      1 
#   q1              q2              q3              Energy
   -42.18928897    -28.05499848    -27.68533983     4.4534309389e-02
   -32.00925814    -28.05499848    -27.68533983     2.3767882545e-02
```
- **座標部分**: `makeGrid.xyz` で生成されたカップリング振動状態の座標を、単体の振動モード座標を用いて重み付けの内積を計算。
- **エネルギー**: カップリング状態の座標でエネルギーを求め、各振動モード単体のエネルギーを引いたもの。

**.dipole** も同様の処理が適用される。


